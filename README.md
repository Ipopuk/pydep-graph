# pydep-graph

Небольшая CLI-утилита для анализа графа зависимостей Python-пакетов и его визуализации.

## Возможности

- Чтение параметров из командной строки.
- Получение **прямых зависимостей** пакета с PyPI (без использования `pip`/сторонних библиотек).
- Построение **полного графа зависимостей** (с транзитивностью) с помощью BFS + рекурсии.
- Игнорирование пакетов, имя которых содержит заданную подстроку.
- Обработка циклических зависимостей.
- **Тестовый режим**: работа с заранее заданным графом из текстового файла (узлы — большие латинские буквы).
- Получение **порядка загрузки** зависимостей (топологическая сортировка).
- Генерация диаграммы в формате **Mermaid** и рендер в **PNG** (через `mmdc`).

## Установка

Требуется Python 3.10+.

git clone <url-репозитория>
cd pydep-graph
pip install .

Для визуализации в PNG нужно установить Mermaid CLI:

npm install -g @mermaid-js/mermaid-cli

(без неё будут генерироваться только `.mmd`-файлы.)

## Быстрый старт

### Реальный пакет с PyPI

depgraph \
  --package requests \
  --repo https://pypi.org/project/requests/ \
  --mode pypi \
  --show-direct-deps \
  --show-load-order \
  --output-image requests-graph.png

Что произойдёт:

- в консоли: конфигурация, прямые зависимости, размер графа, наличие циклов, порядок загрузки;
- на диске: `requests-graph.mmd` (Mermaid) и `requests-graph.png` (PNG-изображение графа).

### Тестовый режим (файл-граф)

Пример файла `test_repo.txt`:

A: B C
B: C D
C: E
D:
E: A

Запуск:

depgraph \
  --package A \
  --repo test_repo.txt \
  --mode test \
  --show-direct-deps \
  --show-load-order \
  --output-image test-graph.png

Можно отфильтровать пакеты по подстроке:

depgraph \
  --package A \
  --repo test_repo.txt \
  --mode test \
  --filter E \
  --output-image test-graph.png

## Основные параметры

- -p, --package — имя анализируемого пакета / узла графа.
- -r, --repo — URL PyPI-страницы или путь к тестовому файлу.
- -m, --mode — режим: pypi или test.
- -o, --output-image — имя PNG-файла с графом (по умолчанию graph.png).
- -f, --filter — подстрока для фильтрации имён пакетов.
- --show-direct-deps — вывод прямых зависимостей.
- --show-load-order — вывод порядка загрузки зависимостей.
- --no-visualization — не генерировать Mermaid/PNG.

## Ограничения

- Зависимости берутся только из метаданных PyPI (поле requires_dist), поэтому возможны отличия от реального поведения pip.
- Для рендера PNG обязательно наличие установленного mmdc.
